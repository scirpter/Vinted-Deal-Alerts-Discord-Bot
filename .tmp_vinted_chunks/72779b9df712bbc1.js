(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,309036,e=>{"use strict";var t=e.i(272946);e.s(["IntlProvider",()=>t.default])},46299,e=>{"use strict";var t=e.i(197262);let r=e=>{let{title:r,titleId:i,...n}=e;return t.createElement("svg",{fill:"none",viewBox:"0 0 24 24",width:24,height:24,"aria-labelledby":i,...n},r?t.createElement("title",{id:i},r):null,t.createElement("path",{fill:"currentColor",d:"M19.53 6.47a.75.75 0 0 1 0 1.06l-10 10a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06L9 15.94l9.47-9.47a.75.75 0 0 1 1.06 0"}))};r.Size=24,r.Title="Checkmark",e.s(["Checkmark24",()=>r],46299)},124222,e=>{"use strict";e.s(["EMAIL_CODE_VERIFICATION_URL",0,"/users/verification/email_code","EMAIL_VERIFICATION_URL",0,"/users/verification/email/new","GOOGLE_OAUTH_URL",0,"/auth/google/oauth","PHONE_VERIFICATION_URL",0,"/users/verification/phone/new","ROOT_URL",0,"/","SECURITY_SETTINGS_2FA_URL",0,"/settings/security/phone_verification","SECURITY_SETTINGS_URL",0,"/settings/security"])},423524,e=>{"use strict";var t=e.i(786830);e.s(["changeExistingEmail",0,e=>{let{email:r,userId:i}=e;return t.api.put(`/users/${i}/change_email`,{email:r})},"dismissVerificationPrompt",0,e=>t.api.delete(`/users/${e}/verifications/prompt`),"getVerificationPrompt",0,e=>t.api.get(`/users/${e}/verifications/prompt`),"resendLoginTwoFactorCode",0,e=>{let{controlCode:r,code:i,fingerprint:n}=e;return t.api.post(`/user_login_2fa/${r}/resend`,{code:i,fingerprint:n})},"resendTwoFactorCode",0,e=>{let{userId:r,id:i,code:n,fingerprint:a}=e;return t.api.post(`/users/${r}/user_2fa/${i}/resend`,{code:n,fingerprint:a})},"resendTwoFactorVerifierCode",0,e=>t.api.post(`/user_verifier/${e}/resend`),"sendEmailVerificationCode",0,e=>{let{userId:r,email:i}=e;return t.api.post(`/users/${r}/verifications/email_code`,{email:i})},"sendTwoFactorCode",0,e=>{let{userId:r,id:i,code:n,fingerprint:a}=e;return t.api.put(`/users/${r}/user_2fa/${i}`,{code:n,fingerprint:a})},"validateEmailVerificationCode",0,e=>{let{userId:r,code:i}=e;return t.api.put(`/users/${r}/verifications/email_code`,{code:i})},"validateUser",0,e=>{let{user:r}=e;return t.api.post("/users/validations",{user:r})},"verifyPhoneNumber",0,e=>{let{userId:r,code:i,phoneNumber:n,fingerprint:a}=e;return t.api.put(`/users/${r}/phone_number/verify`,{code:i,phone_number:n,fingerprint:a})}])},647058,e=>{"use strict";e.s(["clickCancelVerification",0,e=>{let{source:t,userTwoFactorAuthId:r,type:i}=e;return{event:"user.click_cancel_verification",extra:{source:t,type:i,user_two_factor_auth_id:r}}},"clickEvent",0,e=>{let{target:t,screen:r,targetDetails:i,env:n,path:a}=e,s={target:t};return r&&(s.screen=r),i&&(s.target_details=i),n&&(s.env=n),a&&(s.path=a),{event:"user.click",extra:s}},"clickGetHelpVerificationEvent",0,e=>{let{source:t,userTwoFactorAuthId:r,type:i}=e;return{event:"user.click_get_help_verification",extra:{source:t,type:i,user_two_factor_auth_id:r}}},"clickResendVerification",0,e=>{let{source:t,userTwoFactorAuthId:r,type:i}=e;return{event:"user.click_resend_verification",extra:{source:t,type:i,user_two_factor_auth_id:r}}},"clickVerifyEvent",0,e=>{let{source:t,userTwoFactorAuthId:r,type:i}=e;return{event:"user.click_verify",extra:{source:t,type:i,user_two_factor_auth_id:r}}},"closePhonePrefixDropdown",0,()=>({event:"user.close_phone_prefix_dropdown"}),"phoneNumberFormBehaviourEvent",0,e=>{let{taskId:t,action:r,actionDetails:i,userId:n}=e;return{event:"phone_number.form_behaviour",userId:n,extra:{task_id:t,action:r,action_details:i}}},"startPhonePrefixSearch",0,()=>({event:"user.start_phone_prefix_search"}),"twoFAFormBehaviourEvent",0,e=>{let{taskId:t,action:r,actionDetails:i,userId:n}=e;return{event:"phone_verification.form_behaviour",userId:n,extra:{task_id:t,action:r,action_details:i}}},"viewScreenEvent",0,e=>{let{screen:t}=e;return{event:"user.view_screen",extra:{screen:t}}},"viewVerificationScreenEvent",0,e=>{let{source:t,userTwoFactorAuthId:r,type:i}=e;return{event:"user.view_verification_screen",extra:{source:t,type:i,user_two_factor_auth_id:r}}}])},346798,e=>{"use strict";let t=e=>({countryCode:e.country_code,prefix:e.prefix,title:e.title});e.s(["transformEmailVerificationCodeResponse",0,e=>{var t;return{email:e.email,canChangeEmail:null==(t=e.can_change_email)||t}},"transformPhonePrefixDataResponse",0,e=>e.prefixes.map(t),"transformTwoFaDetails",0,e=>{let{id:t,next_resend_available_in:r,show_resend_option:i,user_masked_info:n,type:a}=e;return{controlCode:t,nextResendAvailableIn:r,showResendOption:i,userMaskedInfo:n,channel:a}},"transformTwoFactorVerification",0,e=>({id:e.id,askUser2fa:e.ask_user_2fa,showResendOption:e.show_resend_option,userMaskedPhoneNumber:e.masked_phone_number,userMaskedInfo:e.user_masked_info,nextResendAvailableIn:e.next_resend_available_in,channel:e.type}),"transformVerificationPromptDto",0,e=>({id:e.id,mandatory:e.mandatory,methods:e.methods,category:e.category,actions:e.actions,imageUrls:e.image_urls,translations:{header:e.translations.header,body:e.translations.body},trigger:e.trigger})])},38485,e=>{"use strict";var t=e.i(786830);e.s(["checkEmailVerification",0,()=>t.api.get("/authorization/check/email_verification"),"checkPhoneVerification",0,()=>t.api.get("/authorization/check/phone_verification"),"createUser2FA",0,e=>t.api.post(`/users/${e.userId}/user_2fa`,{entity_id:e.entityId,type:e.entityType,fingerprint:e.fingerprint},{params:{phone_number:e.number}}),"getPhonePrefixData",0,()=>t.api.get("phone_number/prefixes"),"getTwoFADetails",0,e=>t.api.get(`user_verifier/${e}/details`),"getVerificationState",0,(e,r)=>t.api.get(`/users/${e}/verifications/state`,{params:{type:r}}),"setVoluntary2FA",0,(e,r)=>t.api.put(`users/${e}/security/voluntary_2fa`,{is_voluntary_2fa:r})])},600357,e=>{"use strict";var t=e.i(197262),r=e.i(780104),i=e.i(869390),n=e.i(948176);e.s(["useSaveUserConsentString",0,()=>{let e=(0,n.useFeatureSwitch)("web_consent_tracking_enabled");return{saveConsentString:(0,t.useCallback)(()=>{e&&!i.serverSide&&"function"==typeof window.__tcfapi&&window.__tcfapi("getTCData",2,(e,t)=>{t&&(null==e?void 0:e.tcString)&&(0,r.saveUserConsentString)({consentString:e.tcString})})},[e])}}],600357)},734990,e=>{"use strict";var t=e.i(549539),r=e.i(459831),i=e.i(86187),n=e.i(803257),a=e.i(589582),s=e.i(240578),o=e.i(417618),l=e.i(528024),c=e.i(924348),u=e.i(197262),d=e.i(474221),f=e.i(996419),p=e.i(59783),_=e.i(155604),h=e.i(282036),v=e.i(126928),g=e.i(449155),m=e.i(532564),x=e.i(569144),y=e.i(632415),b=e.i(659504),w=e.i(94884),E=e.i(374048),k=e.i(490812),C=e.i(282309),S=e.i(423524),T=e.i(743485),j=e.i(647058),I=e.i(445826),F=e.i(642319),A=e.i(290002),P=e.i(600357),L=e.i(106014),R=e.i(285394),V=e.i(124222),D=e.i(394050),N=e.i(536925);e.s(["default",0,e=>{var z;let B,{verificationType:O,controlCode:U,showResend:M,nextResendAvailableIn:$,maskedInfo:q,maskedNumber:W,twoFAId:H,onCodeSent:G,refUrl:K,redirectUrl:Y,isVerifierEnabled:Q,faqEntryType:J=C.FaqEntryType.SmsVerfication,isAuthPage:X,channel:Z=T.VerificationChannel.Phone,trackTaskId:ee}=e,et=(0,m.useTranslate)("user.two_factor_verification"),{track:er}=(0,g.useTracking)(),ei=null==(z=(0,x.useSession)().user)?void 0:z.id,{register:en,handleSubmit:ea,getValues:es,setError:eo,setFocus:el,setValue:ec,control:eu,formState:{errors:ed,isSubmitting:ef}}=(0,d.useForm)(),[ep,e_]=(0,u.useState)($),[eh,ev]=(0,u.useState)(M),[eg,em]=(0,u.useState)(!1),[ex,ey]=(0,u.useState)(!0),eb=(0,L.useCookie)(),{trackFormSubmitSuccess:ew,trackFormSubmitFailure:eE,trackFaqClick:ek,trackResendClick:eC}=(e=>{var t;let{track:r}=(0,g.useTracking)(),i=(0,u.useRef)(""),n=null==(t=(0,x.useSession)().user)?void 0:t.id;(0,u.useEffect)(()=>{i.current=e||(0,D.v4)()},[e]);let a=(0,u.useCallback)(e=>{let{action:t,actionDetails:a}=e;r((0,j.twoFAFormBehaviourEvent)({taskId:i.current,action:t,actionDetails:a,userId:n}))},[r,n]);(0,N.useEventListener)("beforeunload",()=>{a({action:"end"})}),(0,u.useEffect)(()=>{a({action:"start"})},[a]);let s=(0,u.useCallback)(()=>{a({action:"submit",actionDetails:"success"})},[a]),o=(0,u.useCallback)(()=>{a({action:"submit",actionDetails:"failure"})},[a]);return{trackFormSubmitSuccess:s,trackFormSubmitFailure:o,trackFaqClick:(0,u.useCallback)(()=>{a({action:"click",actionDetails:"faq_link"})},[a]),trackResendClick:(0,u.useCallback)(()=>{a({action:"click",actionDetails:"resend"})},[a])}})(ee),eS=(0,u.useRef)(null),eT=(0,I.useAbTest)("auto_focus_enter_code_field_2fa_v2"),ej=(null==eT?void 0:eT.variant)==="on",eI=(0,I.useAbTest)("disable_verify_cta_2fa_v2"),eF=(null==eI?void 0:eI.variant)==="on",eA=(0,d.useWatch)({control:eu,name:"code"}),{trackIncogniaEvent:eP}=(0,A.useIncogniaTracking)(),{saveConsentString:eL}=(0,P.useSaveUserConsentString)(),eR=(0,w.useFormValidationMessage)(ed),eV=O===T.VerificationType.Phone?"verification_prompt_phone_check":"two_factor_authentication",eD=(0,u.useMemo)(()=>({userTwoFactorAuthId:H?H.toString():U,type:Z,source:O===T.VerificationType.Phone?"verification":"2FA"}),[H,O,Z,U]);(0,F.useTrackAbTest)(eT),(0,F.useTrackAbTest)(eI),(0,u.useEffect)(()=>{er((0,j.viewVerificationScreenEvent)(eD))},[er,eV,eD]),(0,u.useEffect)(()=>{ej&&el("code")},[el,ej]);let eN=(0,u.useCallback)(()=>{eS.current=setInterval(()=>{e_(e=>e-1)},1e3)},[]);(0,u.useEffect)(()=>{eS.current&&ep<=0&&clearInterval(eS.current)},[ep]),(0,u.useEffect)(()=>(eN(),()=>{eS.current&&clearInterval(eS.current)}),[eN]);let ez=async()=>{er((0,j.clickResendVerification)(eD)),eC();try{let e,t=es("code");if(O===T.VerificationType.Login){if(!U)return;if(Q){e=await (0,S.resendTwoFactorVerifierCode)(U);return}e=await (0,S.resendLoginTwoFactorCode)({controlCode:U,code:t,fingerprint:await (0,f.getFingerprint)()})}else{if(!ei)return;e=await (0,S.resendTwoFactorCode)({userId:ei,id:H,code:t,fingerprint:await (0,f.getFingerprint)()})}if("errors"in e)throw Error(e.errors.toString()||"Error while resending");e_(e.next_resend_available_in),ev(e.show_resend_option),eN()}catch{ev(!1),em(!0)}},eB=e=>{eo("code",{type:"manual",message:e})},eO=async e=>{let{code:t}=e;er((0,j.clickVerifyEvent)(eD));try{switch(O){case T.VerificationType.Login:{if(!U)return;let e={grantType:_.AuthenticateGrantType.Password,controlCode:U,verificationCode:t,passwordType:"two_factor_challenge_code",isTrustedDevice:ex,fingerprint:await (0,f.getFingerprint)()},r=await (0,h.authenticateUser)(e);if(await eP({tag:"login"},{response:r}),"errors"in r){eB(r.message||""),eE();return}let i=await (0,h.getCurrentUser)();("errors"in i?void 0:i.user.id)&&eL(),ew(),(0,v.navigateToPage)(K||V.ROOT_URL);break}case T.VerificationType.BankAccount:case T.VerificationType.Checkout:case T.VerificationType.EntityHash:{if(!ei)return;let e=await (0,S.sendTwoFactorCode)({userId:ei,id:H,code:t,fingerprint:await (0,f.getFingerprint)()});if(await eP({tag:"2fa-verification"},{response:e}),"errors"in e){let t=e.errors[0];eB(t.value),eE();return}switch(O){case T.VerificationType.BankAccount:K&&Y&&(0,v.navigateToPage)(`${K}?${(0,E.toUrlQuery)({ref_url:Y})}`);break;case T.VerificationType.Checkout:case T.VerificationType.EntityHash:null==G||G()}ew();break}case T.VerificationType.Phone:{if(!ei||!W)return;let e=await (0,S.verifyPhoneNumber)({userId:ei,code:t,phoneNumber:W,fingerprint:await (0,f.getFingerprint)()});if(await eP({tag:"phone-verification"},{response:e}),"errors"in e){let t=e.errors[0];eB(t.value),eE();return}eb.delete(R.cookiesDataByName.mandatory_verification_required),ew(),K&&(0,v.navigateToPage)(K)}}}catch(e){var r;eB((null==(r=e.response)?void 0:r.data.errors)&&e.response.data.errors.length&&e.response.data.errors[0])}};(0,p.useDataDomeCaptcha)(()=>{ea(eO)()});let eU=()=>{ek(),er((0,j.clickGetHelpVerificationEvent)(eD))},eM=e=>(0,t.jsx)(o.Note,{styling:"narrow",alignment:"center",text:e});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Cell,{body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Text,{as:"h1",text:et("title"),type:"heading",alignment:X?"left":"center",width:"parent"}),(0,t.jsx)(l.Spacer,{size:"large"}),(0,t.jsx)("span",{className:"u-text-wrap",children:et("body",{phone_number:(0,t.jsx)(c.Text,{as:"span",text:q||W,bold:!0,theme:"amplified"},"phone-number")})})]})}),(0,t.jsxs)("form",{onSubmit:ea(eO),children:[(0,t.jsx)(s.InputText,{...en("code",{onChange:e=>{let{target:t}=e,{value:r}=t;eF&&r.length>4&&ec("code",r.slice(0,4))}}),type:"number",validation:(0,b.renderValidation)(eR("code")),placeholder:et("placeholder"),testId:"verification-code",autoComplete:"off"}),O!==T.VerificationType.Login?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Cell,{title:et("trusted_device.title"),body:et("trusted_device.body"),suffix:(0,t.jsx)(n.Checkbox,{testId:"is-trusted-device",name:"isTrustedDevice",checked:ex,onChange:()=>{ey(e=>!e)}})}),(0,t.jsx)(a.Divider,{})]}),(B=(null==eA?void 0:eA.length)||0,(0,t.jsx)(i.Cell,{children:(0,t.jsx)(r.Button,{styling:"filled",text:et("continue"),type:"submit",isLoading:ef,testId:"verify-button",disabled:eF&&B<4||ef})}))]}),(()=>{if(!eh)return null;let e=ep.toString().padStart(2,"0");return(0,t.jsx)(t.Fragment,{children:eM(ep>0?et("resend_counter",{seconds_left:e}):(0,t.jsx)(r.Button,{styling:"flat",size:"small",inline:!0,onClick:ez,text:et("resend_link")}))})})(),eM(et("note",{contact_us:(0,t.jsx)(k.HelpCenterFaqEntryUrl,{type:J,accessChannel:C.AccessChannel.ProductLink,render:e=>(0,t.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",onClick:eU,children:et("contact_us")})},"contact-us-link")})),eg?(0,t.jsx)(y.Notification,{body:et("resend_error")}):null]})}],734990)},763826,e=>{"use strict";var t=e.i(549539),r=e.i(197262),i=e.i(459831),n=e.i(86187),a=e.i(528024),s=e.i(924348),o=e.i(532564),l=e.i(490812),c=e.i(282309),u=e.i(240578),d=e.i(589582),f=e.i(739800),p=e.i(975687),_=e.i(990242),h=e.i(46299),v=e.i(145764),g=e.i(307794),m=e.i(925049),x=e.i(225293),y=e.i(38485),b=e.i(346798),w=e.i(647058),E=e.i(763506),k=e.i(307723),C=e.i(569144),S=e.i(449155);let T=e=>{let{onChange:i,validation:l}=e,c=(0,o.useTranslate)("settings.security.create_phone_number"),[T,j]=(0,r.useState)(""),[I,F]=(0,r.useState)(),[A,P]=(0,r.useState)(""),[L,R]=(0,r.useState)(!1),V=(0,C.useSession)().user,D=(0,r.useRef)(null),N=null==V?void 0:V.country_code,z=(0,E.useBreakpoint)(),{track:B}=(0,S.useTracking)(),{fetch:O,transformedData:U,isLoading:M}=(0,k.useFetch)(y.getPhonePrefixData,b.transformPhonePrefixDataResponse);(0,r.useEffect)(()=>{O()},[O]);let $=(0,r.useMemo)(()=>null==U?void 0:U.filter(e=>e.title.toLowerCase().includes(A)||e.prefix.includes(A)||e.countryCode.includes(A)),[U,A]),q=(0,r.useMemo)(()=>{var e;return I&&U?null==(e=U.find(e=>e.countryCode===I))?void 0:e.prefix:null},[I,U]);(0,r.useEffect)(()=>{var e;if(!N||!U)return;let t=U.find(e=>e.countryCode===N.toLowerCase());F((null==t?void 0:t.countryCode)||(null==(e=U[0])?void 0:e.countryCode))},[N,U]),(0,r.useEffect)(()=>{i(`${q}${T}`)},[q,T,i]);let W=()=>{P("")},H=e=>{let{value:t}=e.currentTarget||e.target;P(t.toLowerCase()),L||(B((0,w.startPhonePrefixSearch)()),R(!0))};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Spacer,{size:"x-large"}),(0,t.jsxs)("div",{className:"u-flexbox u-flex-direction-row",children:[(0,t.jsx)("div",{className:"phone-number-input__prefix",children:(0,t.jsx)(g.InputDropdown,{name:"prefix",textSave:"",styling:"tight",value:q,onChange:e=>{F(e.target.value)},onOpen:()=>{D.current&&D.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"}),B((0,w.clickEvent)({target:"phone_prefix_select"}))},render:e=>(0,t.jsxs)("div",{className:"phone-number-input__dropdown",children:[(0,t.jsx)(_.Container,{children:(0,t.jsx)("div",{children:(0,t.jsx)(p.InputBar,{prefix:(0,t.jsx)("div",{className:"u-flexbox u-fill-height u-align-items-center u-padding-left-regular",children:(0,t.jsx)(f.Icon,{name:v.Search16})}),name:"search",placeholder:c("prefix_search_placeholder"),onChange:H,onValueClear:W})})}),(0,t.jsx)(x.ScrollableArea,{maxHeight:z.phones?"58vh":300,children:(0,t.jsx)(m.SeparatedList,{separator:(0,t.jsx)(d.Divider,{}),children:($||[]).map(r=>{let i,o,l;return(0,t.jsx)("div",{ref:r.countryCode===I?D:null,children:(0,t.jsx)(n.Cell,{type:"navigating",body:(0,t.jsx)(s.Text,{text:r.title,as:"span"}),suffix:(i=r.countryCode,o=r.prefix,(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Text,{text:o,as:"span"}),i===I&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Spacer,{orientation:"vertical"}),(0,t.jsx)(f.Icon,{name:h.Checkmark24,color:"success-default"})]})]})),onClick:(l=r.countryCode,()=>{F(l),P(""),e.closeDropdown(),B((0,w.clickEvent)({target:"phone_prefix_select_option",targetDetails:A}))})})},r.prefix)})})})]}),isSaveButtonShown:!1,onClose:()=>{B((0,w.closePhonePrefixDropdown)()),W()},isScrollable:!1,isLoading:!I||M,isPhone:!!z.phones,readOnly:!0,testId:"phone-number-prefix"})}),(0,t.jsx)(a.Spacer,{size:"large",orientation:"vertical"}),(0,t.jsx)(u.InputText,{placeholder:c("input.placeholder_with_country_code"),name:"number",value:null!=T?T:"",onChange:e=>{j(e.target.value)},testId:"phone-number",styling:"tight",validation:l})]}),(0,t.jsx)(a.Spacer,{size:"x-large"})]})};e.s(["default",0,e=>{let{onConfirm:u,validation:d,isButtonDisabled:f,isAccountProtectFlow:p,onFaqClick:_}=e,h=(0,o.useTranslate)("settings.security.create_phone_number"),[v,g]=(0,r.useState)(""),m=()=>{null==_||_()};return(0,t.jsxs)(n.Cell,{children:[(0,t.jsx)(s.Text,{as:"h1",width:"parent",alignment:"center",type:"heading",text:h("title")}),(0,t.jsx)(a.Spacer,{size:"x-large"}),(0,t.jsx)(s.Text,{as:"span",width:"parent",text:h("body")}),(0,t.jsx)(T,{onChange:e=>{g(e)},validation:d}),(0,t.jsx)(i.Button,{disabled:f,text:h("actions.send"),styling:"filled",onClick:()=>{u(v)},testId:"submit-button"}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Spacer,{size:"x-large"}),(0,t.jsx)(s.Text,{as:"span",text:h("help.text",{help_link:(0,t.jsx)(l.HelpCenterFaqEntryUrl,{type:p?c.FaqEntryType.AccontProtectPhoneVerificationNotWorking:c.FaqEntryType.AddPhoneNumber,render:e=>(0,t.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",onClick:m,children:h("help.link")})},"faq-link")}),alignment:"center",width:"parent",html:!0})]})]})}],763826)},99581,e=>{"use strict";var t=e.i(549539),r=e.i(197262),i=e.i(790797),n=e.i(569144),a=e.i(290708),s=e.i(369536),o=e.i(664253),l=e.i(698152),c=e.i(410802),u=e.i(948176),d=e.i(273854),f=e.i(951768);let p={initialized:!1,stores:e.i(21395).FALLBACK_STORES,providers:null},_=async(t,r)=>{try{let{unsafeInitializeBraze:r}=await e.A(299172);return f.clientSideMetrics.counter("braze_initialization").increment(),await r(t)}catch(e){return null==r||r(e),p}};var h=e.i(592369),v=e.i(285394),g=e.i(106014),m=e.i(399103);let x=(e,t)=>{switch(t.type){case"set_loading":return{state:"loading"};case"set_failure":return{state:"failure"};case"set_success":return{value:t.value,state:"success"};default:return e}};e.s(["default",0,e=>{var f,y;let{children:b}=e,{user:w}=(0,n.useSession)(),[E,k]=(0,r.useReducer)(x,{value:null,state:"loading"}),[C,S]=(0,r.useState)(),[T,j]=(0,r.useState)({...l.initialBrazeContextValue,dispatch:k}),[I,F]=(0,r.useState)(!1),{relativeUrl:A}=(0,i.useBrowserNavigation)(),P=(null==w||null==(f=w.email)?void 0:f.includes("autotestvinted"))&&(null==w||null==(y=w.email)?void 0:y.endsWith("@vinted.com"))||!1,L=(e=>{let{isWebview:t}=(0,n.useSession)(),{crm:i}=(0,d.useSystemConfiguration)()||{},o=null==i?void 0:i.brazeConfig,l=(0,u.useFeatureSwitch)("braze_sdk_enabled"),f=(0,u.useFeatureSwitch)("web_braze_logging"),h=(0,u.useFeatureSwitch)("web_braze_log_app_health"),v=(0,u.useFeatureSwitch)("web_braze_push_notifications"),g=(0,u.useFeatureSwitch)("web_braze_non_error_logging"),m=(0,u.useFeatureSwitch)("braze_sdk_in_webview_enabled"),x=(0,u.useFeatureSwitch)("braze_sdk_cookie_restriction_enabled"),y=l&&(t&&m||!t),{sdkEndpoint:b,sdkKey:w,safariWebsitePushId:E}=o||{},k=e.value;return(0,r.useCallback)(async()=>y?"loading"===e.state?p:k&&w?_({isCookieFSEnabled:x,userExternalId:k,apiKey:w,safariWebsitePushId:v?E:void 0,baseUrl:b||"",logger:h||f?e=>{let t=["error","exception","fail","fatal"].some(t=>e.toLowerCase().includes(t));h&&(g||t)&&(0,c.logBrazeMessage)(`Braze_SDK_log: ${e}`),f&&console.log(e)}:void 0},e=>{(0,a.disableBraze)(),e instanceof Error&&((0,c.logBrazeError)(e),(0,c.trackInitFailureMetrics)(e.message))}):((0,a.disableBraze)(),(0,c.logConfigurationFailure)({brazeSdkKey:w,userExternalId:k}),p):((0,a.disableBraze)(),(0,s.removeAllDeferredBrazeCustomEvents)(),p),[y,x,k,e,w,h,f,v,E,b,g])})(E);!function(e){let{relativeUrl:t,urlParams:n,searchParams:a}=(0,i.useBrowserNavigation)(),s=(0,g.useCookie)(),o="shown"===n.onboarding_modal_status,l=s.get(v.cookiesDataByName.banners_ui_state)===m.UiState.Pending,c=!!a.promo_shown,u=h.WHITELISTING_RULES.some(e=>new RegExp(e).test(t))&&!(o||l||c);(0,r.useEffect)(()=>{e&&(u?(e.enable(),e.publishStoredMessages()):e.disable())},[e,u])}(null==C?void 0:C.inAppMessageProvider),(0,r.useEffect)(()=>{L().then(e=>{let{initialized:t,stores:r,providers:i}=e,n=[r.inboxMessageCardStore,r.inboxNotificationCardStore,r.promoBoxCardStore],a=(0,o.getCardLoggersById)(n);i&&S(i),F(t),j({...r,...a,userExternalId:E,dispatch:k})})},[L,E,k,P]);let R=(0,r.useCallback)(()=>{!E.value||I&&((0,s.flushCustomEventsThrottled)(E.value),(0,a.requestContentCardsRefreshThrottled)())},[I,E]);return(0,r.useEffect)(()=>{R()},[A,R]),(0,t.jsx)(l.default.Provider,{value:T,children:b})}],99581)},42301,e=>{"use strict";var t=e.i(197262),r=e.i(698152);e.s(["BrazeExternalIdSetter",0,e=>{let{userExternalId:i}=e,{dispatch:n}=(0,t.useContext)(r.default);return(0,t.useEffect)(()=>{void 0===i&&n({type:"set_failure"}),i&&n({type:"set_success",value:i})},[i,n]),null}])},245164,e=>{"use strict";var t=e.i(549539),r=e.i(197262),i=e.i(309036),n=e.i(247653),n=n,a=e.i(929064),s=e.i(668707),o=e.i(536925),l=e.i(106014),c=e.i(89689),u=e.i(48096);let d=e=>{let{children:i,ssrConfigs:n}=e,[d,f]=(0,r.useState)(()=>(0,c.getInitialBreakpoints)(n)),p=(0,l.useCookie)();return(0,r.useEffect)(()=>{(0,c.setViewportCookie)(p)},[d,p]),(0,o.useEventListener)("resize",(0,s.default)(()=>{let e=(0,c.getClientSideBreakpoints)();f(t=>(0,a.default)(e,t)?t:e)},50)),(0,t.jsx)(u.Provider,{value:{breakpoints:d},children:i})};var f=e.i(543376);let p=e=>{let{children:r,cookieManager:i}=e;return(0,t.jsx)(f.CookieManagerContext.Provider,{value:i,children:r})};var _=e.i(210586),h=e.i(827215),h=h,v=e.i(38618),g=e.i(276092);let m=()=>{let e=(0,v.useFeatureFlags)();return(0,r.useEffect)(()=>{let t={web_lazy_lock_listing_restriction:e.web_lazy_lock_listing_restriction,web_lazy_lock_terms_and_conditions:e.web_lazy_lock_terms_and_conditions,web_lazy_lock_wallet_conversion:e.web_lazy_lock_wallet_conversion,web_lazy_lock_user_verification:e.web_lazy_lock_user_verification};(0,g.setPageLockFlags)(t)},[e]),null};var x=e.i(681553);let y=e=>{let{pageId:i,children:n,userAgent:a,isBot:s}=e,o=(0,r.useMemo)(()=>({pageId:i,userAgent:a,isBot:s}),[i,a,s]);return(0,t.jsx)(x.default.Provider,{value:o,children:n})};var b=e.i(957742),w=e.i(357891);let E=e=>{let{children:i,url:n}=e,[,a]=(0,r.useState)(!1),s=(0,b.useSearchParams)(),o=(0,b.usePathname)(),l=(0,b.useParams)(),{push:c}=(0,b.useRouter)(),u=(0,r.useCallback)(e=>{var t;return null==(t=globalThis.history)?void 0:t.pushState({},"",e)},[]),d=(0,r.useCallback)(e=>{var t;return null==(t=globalThis.history)?void 0:t.replaceState({},"",e)},[]),f=(0,r.useCallback)(()=>window.history.back(),[]),p=(0,r.useCallback)(()=>a(e=>!e),[]),_=(0,r.useMemo)(()=>{var e;let t,r=new URL(n);return o&&(r.pathname=o),s&&(r.search=s.toString()),{url:r.toString(),serverUrl:n,routerPush:c,push:u,replace:d,refreshUrl:p,back:f,urlParams:{...l,...(e=r.searchParams,t={},e.forEach((e,r)=>{t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(e)):t[r]=e}),t)}}},[n,o,c,l,s,u,d,p,f]);return(0,t.jsx)(w.default.Provider,{value:_,children:i})};var k=e.i(882665),k=k,C=e.i(309655),C=C,S=e.i(917311),S=S,T=e.i(569144),j=e.i(805579),I=e.i(377952),F=e.i(385991);let A=e=>{let{screen:t}=e,i=(0,r.useContext)(I.default),{updateScreenName:n}=(0,F.default)(),{user:a,debugPin:s,anonId:o,trackingPlatform:l,locale:c}=(0,T.useSession)(),u=(0,j.useEnvs)("PORTAL");return(0,r.useEffect)(()=>{(null==i?void 0:i.tracker)&&(i.tracker.updateContext({anonId:o||"",userId:null==a?void 0:a.id,portal:u||"",debugPin:s?Number(s):null,platform:l||null,languageCode:(null==a?void 0:a.locale)||c||"",screen:{width:0,height:0,name:t},utm:{}}),i.tracker.drainEventQueue(),n(t))},[o,s,c,u,t,null==i?void 0:i.tracker,l,n,null==a?void 0:a.id,null==a?void 0:a.locale]),null};var P=e.i(371557),L=e.i(948176),R=e.i(387352),V=e.i(850328),D=e.i(133969);let N=e=>{let{children:i}=e,n=(0,j.useEnvs)("INCOGNIA_WEB_CLIENT_SIDE_KEY"),a=(0,L.useFeatureSwitch)("web_incognia_script"),{user:s}=(0,T.useSession)(),o=(0,r.useRef)(null),l=(0,r.useCallback)(async()=>{if(s){let e;try{e=await (0,R.stringToSha256)(s.id.toString())}catch(e){(0,V.logIncogniaWarning)("Failed to hash user ID for Incognia",{error:e.message});return}try{P.default.setAccountId(e)}catch(e){(0,V.logIncogniaWarning)("Failed to set Incognia account ID",{error:e.message})}return}P.default.clearAccountId()},[s]),c=(0,r.useCallback)(async()=>{if(!n||!a)return;let e=(0,V.incogniaInitializationDurationTimer)();try{await P.default.init({appId:n,customDomain:"metrics.vinted.lt"}),l()}catch(e){(0,V.logIncogniaWarning)("IncogniaWebSdk initialization failed",{error:e.message})}e()},[n,l,a]);(0,r.useEffect)(()=>{o.current=c()},[c]),(0,r.useEffect)(()=>{a&&!n&&(0,V.logIncogniaWarning)("Incognia web client side key is not set")},[n,a]);let u=(0,r.useMemo)(()=>({initializationPromiseRef:o}),[o]);return(0,t.jsx)(D.IncogniaContext.Provider,{value:u,children:i})};var z=e.i(285653);let B=(e,t)=>i=>(0,r.createElement)(e,t,i);e.s(["default",0,e=>{var a;let s,{children:o,featureSwitchesProps:l,systemConfigurationProps:c,sessionProps:u,abTestsProps:f,intlProps:v,cookies:g,nextRequestProps:x,browserNavigationProps:b,breakpointProps:w,consentProps:T,screen:j}=e,I=(0,r.useRef)(null);null!=I.current||(I.current=(0,_.createCookieManager)(g));let F=null==(a=l.featureSwitches)?void 0:a.web_client_root_params,P=null==(s=(0,z.default)())?void 0:s.countryCode,L=F?{...c,configuration:{...c.configuration,userCountry:P}}:c,R=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A,{screen:j}),(0,t.jsx)(m,{}),o]});return[B(h.default,l),B(C.default,L),B(k.default,u),B(n.default,f),B(i.IntlProvider,v),B(p,{cookieManager:I.current}),B(y,x),B(E,b),B(d,w),B(N),B(S.default,T)].reduceRight((e,t)=>t(e),R)}],245164)},177357,e=>{"use strict";var t,r=e.i(197262),i=e.i(449155),n=e.i(208072),a=e.i(948176),s=e.i(532564),o=((t={}).BannerAccept="banner_accept_all",t.BannerReject="banner_reject_all",t.PreferenceCenterAccept="preference_center_accept_all",t.PreferenceCenterReject="preference_center_reject_all",t),l=e.i(703908);e.s(["default",0,()=>{let[e,t]=(0,r.useState)(!1),c=(0,n.useUserAgent)(),u=(0,s.useTranslate)("consent_banner"),d=(0,a.useFeatureSwitch)("web_consent_tracking"),{track:f}=(0,i.useTracking)();return(0,r.useLayoutEffect)(()=>{let e=null,t=()=>{e&&(clearTimeout(e),e=null)},r=()=>{let i=document.getElementById("onetrust-banner-sdk");if(!i){e=setTimeout(r,300);return}i.classList.add("onetrust-banner-sdk--loaded"),t()};return r(),t},[]),(0,r.useEffect)(()=>{if(!d)return;let r=null,i=null,n=null,a=null,s=null,u=r=>{e||(f((e=>{let{action:t,isMobile:r}=e;return{event:"user.cmp_action",extra:{action:t,isMobile:r}}})({action:r,isMobile:(0,l.isMobile)(c)})),t(!0))},p=new MutationObserver(()=>{r=document.getElementById("onetrust-accept-btn-handler"),i=document.getElementById("onetrust-reject-all-handler"),n=document.getElementById("accept-recommended-btn-handler"),a=document.querySelector(".ot-pc-refuse-all-handler"),s=document.querySelector(".save-preference-btn-handler"),r&&i&&n&&a&&s&&(r.addEventListener("click",()=>u(o.BannerAccept)),i.addEventListener("click",()=>u(o.BannerReject)),n.addEventListener("click",()=>u(o.PreferenceCenterAccept)),a.addEventListener("click",()=>u(o.PreferenceCenterReject)),p.disconnect())});return p.observe(document.body,{childList:!0,subtree:!0}),()=>{p.disconnect(),r&&r.removeEventListener("click",()=>u),i&&i.removeEventListener("click",()=>u),n&&n.removeEventListener("click",()=>u),a&&a.removeEventListener("click",()=>u)}},[e,f,c,d,u]),null}],177357)},497554,e=>{"use strict";var t=e.i(549539),r=e.i(197262),i=e.i(206435),n=e.i(884816),a=e.i(65963),s=e.i(536925),o=e.i(996419),l=e.i(569144),c=e.i(346798),u=e.i(743485),d=e.i(38485),f=e.i(647058),p=e.i(449155),_=e.i(294111),h=e.i(734990),v=e.i(459831),g=e.i(256797),m=e.i(528024),x=e.i(924348),y=e.i(86187),b=e.i(116692),w=e.i(532564),E=e.i(598449),k=e.i(490812),C=e.i(282309),S=e.i(445826),T=e.i(642319),j=e.i(763826);let I=e=>{var i;let{entityId:n,onConfirm:a}=e,s=(0,E.useAsset)("/assets/verifications/add-phone-number"),f=(0,w.useTranslate)("user.two_factor_verification.add_phone_number"),p=(0,S.useAbTest)("global_2fa_phone_number_screen_update"),_=(null==p?void 0:p.variant)==="on",h=_?"_updated":"";(0,T.useTrackAbTest)(p);let I=null==(i=(0,l.useSession)().user)?void 0:i.id,[F,A]=(0,r.useState)(!1),[P,L]=(0,r.useState)(),R=async e=>{if(!I)return;let t=await (0,d.createUser2FA)({userId:I,entityId:n,number:e,fingerprint:await (0,o.getFingerprint)(),entityType:u.VerificationType.EntityHash});if("errors"in t){let e=t.errors[0];L(null==e?void 0:e.value);return}a((0,c.transformTwoFactorVerification)(t))};return F?(0,t.jsx)(j.default,{onConfirm:R,isAccountProtectFlow:!1,validation:P&&(0,t.jsx)(b.Validation,{text:P,theme:"warning"})}):(0,t.jsxs)(y.Cell,{children:[(0,t.jsx)(m.Spacer,{size:_?"x2-large":"x4-large"}),(0,t.jsx)("div",{className:"u-flexbox u-align-items-center",children:(0,t.jsx)(g.Image,{src:s(_?"shield-phone-girl.svg":"phone-lock.svg",{theme:{dark:_?"shield-phone-girl.svg":"dark/phone-lock.svg"}}),size:_?"x4-large":"x3-large",alt:f("title"),scaling:"contain"})}),(0,t.jsx)(m.Spacer,{size:_?"x2-large":"x4-large"}),(0,t.jsx)(x.Text,{text:f(`title${h}`),type:"heading-xl",as:"h1",alignment:"center",width:"parent"}),(0,t.jsx)(m.Spacer,{size:"large"}),(0,t.jsx)(x.Text,{text:f(`body${h}`),html:!0,as:"p"}),(0,t.jsx)(m.Spacer,{size:"x2-large"}),(0,t.jsx)(v.Button,{text:f("actions.add_phone"),onClick:()=>{A(!0)},styling:"filled"}),(0,t.jsx)(m.Spacer,{size:"large"}),(0,t.jsx)(k.HelpCenterFaqEntryUrl,{type:C.FaqEntryType.AddPhoneNumber,render:e=>(0,t.jsx)(v.Button,{text:f("actions.faq"),url:e,urlProps:{target:"_blank"}})})]})},F=e=>{var i;let{entityId:v,onCodeSent:g,onError:m}=e,x=null==(i=(0,l.useSession)().user)?void 0:i.id,{track:y}=(0,p.useTracking)(),[b,w]=(0,r.useState)(!1),[E,k]=(0,r.useState)(null),[C,S]=(0,r.useState)(!1);(0,s.useEventListener)(n.TWO_FA_CANCELLED_EVENT,()=>{var e;y((0,f.clickCancelVerification)({type:null!=(e=null==E?void 0:E.channel)?e:u.VerificationChannel.Sms,source:"2FA",userTwoFactorAuthId:null==E?void 0:E.id.toString()}))});let T=async e=>(0,d.createUser2FA)({userId:e.userId,entityId:e.entityId,entityType:u.VerificationType.EntityHash,fingerprint:await (0,o.getFingerprint)()});return((0,r.useEffect)(()=>{x&&v&&(async()=>{S(!0);let e=await T({userId:x,entityId:v});if(S(!1),"errors"in e)return e.code===_.ResponseCode.PhoneNumberRequired?w(!0):m();k((0,c.transformTwoFactorVerification)(e))})()},[x,v,m]),C)?(0,t.jsx)("div",{className:"u-flexbox u-justify-content-center",children:(0,t.jsx)(a.Loader,{size:"x-large",testId:"global-two-FA-loader"})}):b?(0,t.jsx)(I,{onConfirm:e=>{x&&(w(!1),k(e))},entityId:v}):E?(0,t.jsx)(h.default,{verificationType:u.VerificationType.EntityHash,maskedInfo:E.userMaskedInfo,nextResendAvailableIn:E.nextResendAvailableIn,showResend:E.showResendOption,twoFAId:E.id,onCodeSent:g,channel:E.channel}):null};e.s(["default",0,()=>{let[e,a]=(0,r.useState)(null);return((0,r.useEffect)(()=>{let e=e=>{a(e.detail)};return window.addEventListener("twoFARequired",e),()=>{window.removeEventListener("twoFARequired",e)}},[]),e)?(0,t.jsx)(i.Dialog,{show:!!e,closeOnOverlay:!0,defaultCallback:()=>{a(null),window.dispatchEvent(new Event(n.TWO_FA_CANCELLED_EVENT))},testId:"global-2fa-modal",children:(0,t.jsx)(F,{entityId:e,onCodeSent:()=>{a(null),window.dispatchEvent(new Event(n.TWO_FA_COMPLETED_EVENT))},onError:()=>{a(null)}})}):null}],497554)},808e3,e=>{"use strict";var t=e.i(549539),r=e.i(839701),i=e.i(197262),n=e.i(536925),a=e.i(805579),s=e.i(449155),o=e.i(948176),l=e.i(807999);let c=e=>{let{actionType:t,fingerprint:r,endpointName:i,responseType:n}=e;return{event:"system.datadome_script_action",extra:{action_type:t,fingerprint:r,endpoint_name:i,response_type:n}}};var u=e.i(996419),d=e.i(719542),f=e.i(182716);e.s(["default",0,()=>{let{track:e}=(0,s.useTracking)(),p=(0,i.useRef)(""),_=(0,a.useEnvs)("DATADOME_CLIENT_SIDE_KEY"),h=(0,o.useFeatureSwitch)("datadome_assessment"),v=(0,o.useFeatureSwitch)("datadome_script_tracking"),g=(0,o.useFeatureSwitch)("datadome_web_override_abort_fetch"),m=(0,o.useFeatureSwitch)("datadome_sandbox_script_source"),x=(0,o.useFeatureSwitch)("datadome_production_script_source"),y=async()=>({fingerprint:await (0,u.getFingerprint)(),endpointName:p.current});return((0,n.useEventListener)(d.DD_BLOCKED_EVENT,async t=>{v&&(p.current=t.detail.url,e(c({...await y(),actionType:"blocked"})))}),(0,n.useEventListener)(d.DD_RESPONSE_DISPLAYED_EVENT,async t=>{v&&e(c({...await y(),actionType:"response_displayed",responseType:t.detail.responseType}))}),(0,n.useEventListener)(d.DD_RESPONSE_UNLOAD_EVENT,async t=>{v&&e(c({...await y(),actionType:"response_passed",responseType:t.detail.responseType}))}),(0,n.useEventListener)(d.DD_RESPONSE_ERROR_EVENT,async()=>{v&&e(c({...await y(),actionType:"response_error"}))}),(0,i.useEffect)(()=>{h&&!_&&(0,l.logWarning)("DataDome client-side key is not set")},[_,h]),(0,i.useEffect)(()=>{let e=(0,f.dataDomeInitializationTimer)();return window.addEventListener(d.DD_READY_EVENT,e),()=>{window.removeEventListener(d.DD_READY_EVENT,e)}},[h,_]),h&&_)?(0,t.jsx)(r.default,{id:"data-dome-script",strategy:"afterInteractive",children:`!function(a,b,c,d,e,f){a.ddjskey=e;a.ddoptions=f||null;var m=b.createElement(c),n=b.getElementsByTagName(c)[0];m.async=1,m.src=d,n.parentNode.insertBefore(m,n)}(window,document,"script","${m||x?"https://static-assets.vinted.com/datadome/5.3.0/tags.js":"https://dd.vinted.lt/tags.js"}","${_}", ${JSON.stringify({ajaxListenerPath:!0,disableAutoRefreshOnCaptchaPassed:!0,enableTagEvents:!0,abortAsyncOnCaptchaDisplay:!1,endpoint:"https://dd.vinted.lt/js",overrideAbortFetch:g})});`}):null}],808e3)}]);